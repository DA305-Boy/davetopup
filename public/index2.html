<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <title>Dave TopUp Shop Films</title>
  <style>
    body { margin:0; font-family:"Poppins",sans-serif; background-color:#f6faf7; }
    header { display:flex; justify-content:space-between; align-items:center; padding:8px 8px; background:white; box-shadow:0 1px 3px rgba(0,0,0,0.1); position:fixed; top:0; width:100%; z-index:10; }
    .logo img { height:40px; }
    .search-bar { flex:1; max-width:250px; display:flex; align-items:center; gap:4px; }
    .search-bar input { flex:1; padding:3px 5px; border:1px solid #ccc; border-radius:6px; font-size:12px; }
    .search-bar button { padding:3px 6px; font-size:13px; border:none; border-radius:6px; background:#2f855a; color:#fff; cursor:pointer; }
    .search-bar button:hover { background:#276749; }
    .icons { display:flex; align-items:center; gap:10px; }
    .cart-btn { font-size:15px; background:none; border:none; cursor:pointer; padding:3px; }
    .menu-btn { font-size:30px; background:none; border:none; cursor:pointer; padding:3px; }
    .side-menu { position:fixed; top:0; right:-250px; width:220px; height:100%; background:#fff; box-shadow:-3px 0 15px rgba(0,0,0,0.1); padding:8px; transition:right 0.3s ease; z-index:20; }
    .side-menu.open { right:0; }
    .side-menu ul { list-style:none; padding:0; margin:60px 0 0 0; }
    .side-menu ul li { margin:12px 0; }
    .side-menu ul li a { text-decoration:none; color:#333; font-size:13px; }
    .side-menu .submenu li a { font-size:12px; }
    .close-btn { position:absolute; top:12px; right:15px; font-size:24px; cursor:pointer; background:none; border:none; }
    main { margin-top:90px; padding:20px; text-align:center; opacity:1; transition:opacity 0.5s ease; }
    .grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(160px,1fr)); gap:20px; margin-top:25px; }
    .card { background:white; border-radius:10px; padding:15px; box-shadow:0 2px 5px rgba(0,0,0,0.1); }
    .card img { width:100%; border-radius:8px; height:120px; object-fit:cover; }
    .card p { color:gray; font-size:13px; margin:8px 0 2px; }
    .card h3 { margin:4px 0 8px; font-size:16px; font-weight:600; }
    .btn { display:inline-block; background:#2f855a; color:white; text-decoration:none; padding:8px 12px; border-radius:6px; font-size:14px; }
    .btn:hover { background:#276749; }
    .cart-panel { position:fixed; top:0; left:-300px; width:260px; height:100%; background:#fff; box-shadow:3px 0 10px rgba(0,0,0,0.1); padding:20px; transition:left 0.3s ease; z-index:25; }
    .cart-panel.open { left:0; }
    footer { text-align:center; padding:15px; font-size:13px; color:#777; background:#fff; border-top:1px solid #ddd; margin-top:30px; }
    /* ================== PAGINATION PRO ================== */
.pager {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 10px;
    margin: 30px 0;
    flex-wrap: wrap;
}

/* Bouton n√≤mal */
.page-btn {
    padding: 10px 16px;
    background: #ffffff;
    border: 1px solid #cdd6e0;
    border-radius: 10px;
    font-size: 15px;
    font-weight: 600;
    color: #2b9ed8; /* accent ble */
    cursor: pointer;
    transition: all 0.25s ease;
    box-shadow: 0 2px 6px rgba(0,0,0,0.08);
}

/* Hover bouton */
.page-btn:hover {
    background: #2b9ed8;
    color: #fff;
    transform: translateY(-2px);
    box-shadow: 0 6px 18px rgba(0,0,0,0.12);
}

/* Bouton Prev/Next */
.page-btn.prev, 
.page-btn.next {
    font-weight: 700;
    background: #f0f4f8;
    border-color: #cdd6e0;
}
.page-btn.prev:hover, 
.page-btn.next:hover {
    background: #2b9ed8;
    color: #fff;
}

/* Bouton aktif */
.page-btn.active {
    background: #2b9ed8;
    color: #fff;
    border-color: #2b9ed8;
    box-shadow: 0 6px 18px rgba(0,0,0,0.15);
}

/* Responsive */
@media (max-width: 480px) {
    .pager {
        gap: 6px;
    }
    .page-btn {
        padding: 8px 12px;
        font-size: 14px;
    }
}

/* =====================================
BOT ICON
===================================== */
.bot-icon {
position: fixed;
bottom: 30px;
right: 30px;
width: 60px;
height: 60px;
border-radius: 50%;
overflow: hidden;
cursor: pointer;
box-shadow: 0 2px 6px rgba(0,0,0,0.3);
transition: transform 0.3s;
}
.bot-icon:hover { transform: scale(1.1); }
.bot-icon img { width: 100%; height: 100%; object-fit: cover; }

/* === Top Buttons Bar === */
.top-buttons {
  display: flex;
  justify-content: center;
  align-items: center;
  flex-wrap: wrap;
  gap: 8px;
  background: #fff;
  padding: 8px 5px;
  margin-top: 55px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.08);
  position: sticky;
  top: 55px;
  z-index: 9;
}

.nav-btn {
  background: #2f855a;
  color: white;
  border: none;
  padding: 6px 10px;
  border-radius: 8px;
  font-size: 13px;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 6px;
  transition: background 0.3s, transform 0.2s;
}

.nav-btn:hover {
  background: #276749;
  transform: scale(1.05);
}

/* === Loader Animation === */
.loader-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(255,255,255,0.9);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 999;
}

.loader {
  border: 6px solid #ccc;
  border-top: 6px solid #2f855a;
  border-radius: 50%;
  width: 50px;
  height: 50px;
  animation: spin 0.8s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.promo-banner {
  position: absolute; /* sou t√®t t√®ks */
  top: 95px; /* anba header la, anwo main content */
  left: 50%;
  transform: translateX(-50%);
  width: 320px; /* gwos√® ti banner */
  max-width: 90%;
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 4px 15px rgba(0,0,0,0.3);
  display: none;  /* kache pa default */
  z-index: 999;
  cursor: pointer;
  animation: fadeInOut 5s forwards;
}

.promo-banner img {
  width: 100%;
  display: block;
  height: 140px;
  object-fit: cover;
}

.promo-text {
  position: absolute;
  bottom: 0;
  width: 100%;
  padding: 6px 10px;
  background: rgba(0,0,0,0.6);
  color: #fff;
  font-size: 13px;
  text-align: center;
}

/* Animation fade in / fade out */
@keyframes fadeInOut {
  0% { opacity: 0; transform: translateX(-50%) translateY(-20px);}
  10% { opacity: 1; transform: translateX(-50%) translateY(0);}
  90% { opacity: 1; transform: translateX(-50%) translateY(0);}
  100% { opacity: 0; transform: translateX(-50%) translateY(-20px);}
}
  </style>
</head>
<body>

<header>
  <div class="logo">
    <a href="index.html"><img src="https://files.catbox.moe/iatbhv.png" alt="Dave TopUp"></a>
  </div>
  <div class="search-bar">
    <input type="text" id="searchInput" placeholder="Rechercher un film...">
    <button id="searchBtn">üîç</button>
  </div>
  <div class="icons">
    <button class="cart-btn" id="openCart"><i class="fa-solid fa-cart-shopping"></i></button>
    <button class="menu-btn" id="openMenu">‚ò∞</button>
  </div>
</header>

<div class="side-menu" id="sideMenu">
  <button class="close-btn" id="closeMenu">√ó</button>
  <ul>
    <li><a href="index1.html">Accueil</a></li>
    <li><a href="Support/Apple.html">Apple Card</a></li>
    <li><a href="Support/exchange.html">Exchange</a></li>
    <li><a href="Support/wallet.html">Mon Portefeuille</a></li>
    <li><a href="Support/parameter.html">Param√®tres</a></li>
    <li class="support-item">
      <a href="#" id="supportLink">Support ‚ñº</a>
      <ul class="submenu" id="supportSubmenu" style="display:none; margin-left:15px;">
        <li><a href="Support/tuto2.html">Tutoriel</a></li>
        <li><a href="Support/assistant.html">Assistant</a></li>
        <li><a href="Support/politique.html">Politique & Confidentialit√©</a></li>
      </ul>
    </li>
  </ul>
</div>

<div class="cart-panel" id="cartPanel">
  <button class="close-btn" id="closeCart">√ó</button>
  <h3>Votre Panier</h3>
  <p>Aucun article ajout√©.</p>
</div>

<!-- Promo Banner -->
<div id="promoBanner" class="promo-banner">
  <a id="promoLink" href="#" target="_blank">
    <img id="promoImg" src="https://files.catbox.moe/9vduq3.jpeg" alt="Promo Game">
    <div class="promo-text">Special Offer! TopUp your favorite games now and get bonus rewards!</div>
  </a>
</div>
 <!-- Top Navigation Buttons -->
<div class="top-buttons">
  <button class="nav-btn" data-page="index3.html"><i class="fa-solid fa-store"></i> Shop</button>
  <button class="nav-btn" data-page="Shop/boys.html"><i class="fa-solid fa-person"></i> Boys</button>
  <button class="nav-btn" data-page="Shop/womens.html"><i class="fa-solid fa-person-dress"></i> Womens</button>
  <button class="nav-btn" data-page="Shop/kids.html"><i class="fa-solid fa-child"></i> Kids</button>
  <button class="nav-btn" data-page="feature/service.html"><i class="fa-solid fa-hand-holding-heart"></i> Services</button>
  <button class="nav-btn" data-page="movie.html"><i class="fa-solid fa-bolt"></i> Movie</button>
  <button class="nav-btn" data-page="feature/offers.html"><i class="fa-solid fa-tags"></i> Offers</button>
</div>

<!-- Loader Animation -->
<div id="pageLoader" class="loader-overlay" style="display:none;">
  <div class="loader"></div>
</div>

<main>
  <h2>Bienvenue sur Sky TopUp - Films</h2>
  <p>Choisissez vos applications de streaming pr√©f√©r√©es pour visionner facilement.</p>

  <div class="grid" id="productGrid">
    <div class="card" data-product="netflix" data-price="14.99"><img src="https://files.catbox.moe/luzeoi.jpeg" alt="Netflix"><p>Films & S√©ries</p><h3>Netflix</h3><button class="btn checkout-btn" onclick="initiateCheckout(event, 'netflix', 'Netflix', 14.99)">ACHETER</button></div>
    <div class="card" data-product="disney" data-price="10.99"><img src="https://files.catbox.moe/jlidym.jpeg" alt="Disney+"><p>Films & S√©ries</p><h3>Disney+</h3><button class="btn checkout-btn" onclick="initiateCheckout(event, 'disney', 'Disney+', 10.99)">ACHETER</button></div>
    <div class="card" data-product="amazon" data-price="12.99"><img src="https://files.catbox.moe/cedwal.jpeg" alt="Amazon Prime"><p>Films & S√©ries</p><h3>Amazon Prime</h3><button class="btn checkout-btn" onclick="initiateCheckout(event, 'amazon', 'Amazon Prime', 12.99)">ACHETER</button></div>
    <div class="card" data-product="hulu" data-price="7.99"><img src="https://files.catbox.moe/qk7ajp.jpeg" alt="Hulu"><p>Films & S√©ries</p><h3>Hulu</h3><button class="btn checkout-btn" onclick="initiateCheckout(event, 'hulu', 'Hulu', 7.99)">ACHETER</button></div>
    <div class="card" data-product="hbo" data-price="15.99"><img src="https://files.catbox.moe/1jcgvn.jpeg" alt="HBO Max"><p>Films & S√©ries</p><h3>HBO Max</h3><button class="btn checkout-btn" onclick="initiateCheckout(event, 'hbo', 'HBO Max', 15.99)">ACHETER</button></div>
    <div class="card" data-product="appletv" data-price="9.99"><img src="https://files.catbox.moe/q71bid.jpeg" alt="Apple TV"><p>Films & S√©ries</p><h3>Apple TV+</h3><button class="btn checkout-btn" onclick="initiateCheckout(event, 'appletv', 'Apple TV+', 9.99)">ACHETER</button></div>
  </div>

  <div class="pager" id="pager">
    <button class="page-btn prev" data-page="index1.html">‚Üê Prev</button>
    <button class="page-btn" data-page="index1.html">1</button>
    <button class="page-btn" data-page="index2.html">2</button>
    <button class="page-btn" data-page="index3.html">3</button>
    <button class="page-btn next" data-page="index3.html">Next ‚Üí</button>
  </div>
</main>

<footer>
  ¬© 2025 Sky TopUp ‚Äî Tous droits r√©serv√©s.
</footer>

<!-- BOT ICON -->
<div class="bot-icon" onclick="window.location.href='Films/Film-bot.html'">
<img src="https://files.catbox.moe/yvd8nt.png" alt="Bot Shop">
</div>

<script>
const openMenu = document.getElementById('openMenu');
const closeMenu = document.getElementById('closeMenu');
const sideMenu = document.getElementById('sideMenu');
const openCart = document.getElementById('openCart');
const closeCart = document.getElementById('closeCart');
const cartPanel = document.getElementById('cartPanel');
const supportLink = document.getElementById("supportLink");
const supportSubmenu = document.getElementById("supportSubmenu");


// Menu toggle
openMenu.addEventListener('click', () => sideMenu.classList.add('open'));
closeMenu.addEventListener('click', () => sideMenu.classList.remove('open'));

// Cart toggle
openCart.addEventListener('click', () => cartPanel.classList.add('open'));
closeCart.addEventListener('click', () => cartPanel.classList.remove('open'));

// Support submenu toggle
supportLink.addEventListener("click", e => {
  e.preventDefault();
  supportSubmenu.style.display = supportSubmenu.style.display === "none" ? "block" : "none";
});

// Search button
document.getElementById("searchBtn").addEventListener("click", () => {
  const query = document.getElementById("searchInput").value.trim();
  if(query) alert("Vous cherchez: " + query);
});

// Pager
const pagerBtns = document.querySelectorAll('.page-btn');
const mainSection = document.querySelector('main');

pagerBtns.forEach(btn => {
  btn.addEventListener('click', () => {
    pagerBtns.forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    mainSection.style.opacity = "0";
    setTimeout(() => window.location.href = btn.dataset.page, 400);
  });
});

// Active button based on current page
const currentPage = window.location.pathname.split('/').pop();
pagerBtns.forEach(btn => { if(btn.dataset.page === currentPage) btn.classList.add('active'); });

// Fade in on load
window.addEventListener("load", () => {
  mainSection.style.opacity = "0";
  setTimeout(() => { mainSection.style.opacity = "1"; }, 150);
});

// === Top Buttons Navigation ===
const navBtns = document.querySelectorAll('.nav-btn');
const loader = document.getElementById('pageLoader');

navBtns.forEach(btn => {
  btn.addEventListener('click', () => {
    loader.style.display = 'flex'; // montre animation loading lan
    setTimeout(() => {
      window.location.href = btn.dataset.page;
    }, 1300); // retade 1.3 segonn pou animation lan par√®t
  });
});

// Lis promo images + links + messages
const promos = [
  {
    img: "https://files.catbox.moe/9vduq3.jpeg",
    link: "https://example.com/game1",
    text: "Special Offer! TopUp your favorite games now and get bonus rewards!"
  },
  {
    img: "https://files.catbox.moe/cmns4z.jpeg",
    link: "https://example.com/game2",
    text: "Boost your PUBG Mobile account today and claim extra coins!"
  },
  {
    img: "https://files.catbox.moe/bzqxuv.jpeg",
    link: "https://example.com/game3",
    text: "Blood Strike top-up promo: double diamonds for a limited time!"
  }
];

let currentPromo = 0;
const promoBanner = document.getElementById("promoBanner");
const promoImg = document.getElementById("promoImg");
const promoLink = document.getElementById("promoLink");
const promoText = document.querySelector(".promo-text");

function showPromoBanner() {
  // Chwazi pwochen promo
  currentPromo = (currentPromo + 1) % promos.length;
  promoImg.src = promos[currentPromo].img;
  promoLink.href = promos[currentPromo].link;
  promoText.textContent = promos[currentPromo].text;

  // Montre banner
  promoBanner.style.display = 'block';

  // F√® li dispar√®t apre 5s
  setTimeout(() => {
    promoBanner.style.display = 'none';
  }, 5000);
}

// Premye fwa montre apre 1s
setTimeout(showPromoBanner, 1000);

// Apre sa montre chak 20s
setInterval(showPromoBanner, 30000);

document.querySelectorAll('.page-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    const page = btn.getAttribute('data-page');
    if (page) window.location.href = page;
  });
});

// ===== CHECKOUT API INTEGRATION =====
const API_BASE_URL = window.location.origin + '/api';
const CHECKOUT_ENDPOINT = API_BASE_URL + '/checkout';

// Resolve API base URL (Vite env or fallback)
function getApiBase() {
  if (typeof import.meta !== 'undefined' && import.meta.env?.VITE_API_URL) {
    return import.meta.env.VITE_API_URL;
  }
  if (window.VITE_API_URL) return window.VITE_API_URL;
  if (window.REACT_APP_API_BASE) return window.REACT_APP_API_BASE;
  return window.location.origin + '/api';
}

const apiBase = getApiBase();

// Initiate checkout for a product
function initiateCheckout(event, productId, productName, price) {
  event.preventDefault();
  
  // Create checkout modal
  const modal = document.createElement('div');
  modal.id = 'checkoutModal';
  modal.style.cssText = `
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0,0,0,0.7); display: flex; justify-content: center;
    align-items: center; z-index: 1000;
  `;
  
  const content = document.createElement('div');
  content.style.cssText = `
    background: white; padding: 30px; border-radius: 12px;
    width: 90%; max-width: 500px; box-shadow: 0 8px 32px rgba(0,0,0,0.2);
  `;
  
  content.innerHTML = `
    <h2 style="margin-top: 0;">Checkout - ${productName}</h2>
    <p style="color: #666; font-size: 14px;">Price: <strong>$${price.toFixed(2)}</strong></p>
    
    <form id="quickCheckoutForm" style="margin: 20px 0;">
      <div style="margin-bottom: 15px;">
        <label for="userEmail" style="display: block; margin-bottom: 5px; font-weight: 600;">Email</label>
        <input type="email" id="userEmail" name="email" required style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box;">
      </div>
      
      <div style="margin-bottom: 15px;">
        <label for="userName" style="display: block; margin-bottom: 5px; font-weight: 600;">Full Name</label>
        <input type="text" id="userName" name="name" required style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box;">
      </div>
      
      <div style="margin-bottom: 15px;">
        <label for="userCountry" style="display: block; margin-bottom: 5px; font-weight: 600;">Country</label>
        <input type="text" id="userCountry" name="country" required style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box;">
      </div>
      
      <div style="margin-bottom: 20px;">
        <label for="paymentMethod" style="display: block; margin-bottom: 5px; font-weight: 600;">Payment Method</label>
        <select id="paymentMethod" name="paymentMethod" required style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box;">
          <option value="">Select payment method</option>
          <option value="stripe">Credit Card (Stripe)</option>
          <option value="paypal">PayPal</option>
          <option value="crypto">Cryptocurrency</option>
        </select>
      </div>
      
      <div id="checkoutError" style="color: #d32f2f; margin-bottom: 15px; display: none;"></div>
      
      <div style="display: flex; gap: 10px;">
        <button type="button" id="cancelCheckout" style="flex: 1; padding: 10px; background: #ccc; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">Cancel</button>
        <button type="button" id="proceedCheckout" onclick="proceedCheckout(event, '${productId}', '${productName}', ${price})" style="flex: 1; padding: 10px; background: #2f855a; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">Proceed</button>
      </div>
    </form>
  `;
  
  modal.appendChild(content);
  document.body.appendChild(modal);
  
  // Close modal handlers
  document.getElementById('cancelCheckout').addEventListener('click', () => {
    modal.remove();
  });
  
  modal.addEventListener('click', (e) => {
    if (e.target === modal) modal.remove();
  });
}

// Proceed with checkout
async function proceedCheckout(event, productId, productName, price) {
  event.preventDefault();
  
  const form = document.getElementById('quickCheckoutForm');
  const errorDiv = document.getElementById('checkoutError');
  const proceedBtn = event.target;
  
  // Validate form
  if (!form.checkValidity()) {
    errorDiv.textContent = 'Please fill in all required fields.';
    errorDiv.style.display = 'block';
    return;
  }
  
  const formData = new FormData(form);
  const checkoutData = {
    email: formData.get('email'),
    name: formData.get('name'),
    country: formData.get('country'),
    paymentMethod: formData.get('paymentMethod'),
    productId: productId,
    productName: productName,
    amount: price,
    currency: 'USD',
  };
  
  proceedBtn.disabled = true;
  proceedBtn.textContent = 'Processing...';
  errorDiv.style.display = 'none';
  
  try {
    // Call checkout API
    const response = await fetch(apiBase + '/checkout', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(checkoutData),
    });
    
    const result = await response.json();
    
    if (result.success) {
      // Payment successful
      alert('Payment successful! Order ID: ' + result.orderId);
      
      // Close modal and show success
      const modal = document.getElementById('checkoutModal');
      if (modal) modal.remove();
      
      // Redirect to order details or success page after 2s
      setTimeout(() => {
        window.location.href = 'success.html?orderId=' + result.orderId;
      }, 2000);
    } else {
      errorDiv.textContent = result.message || 'Checkout failed. Please try again.';
      errorDiv.style.display = 'block';
      proceedBtn.disabled = false;
      proceedBtn.textContent = 'Proceed';
    }
  } catch (error) {
    console.error('Checkout error:', error);
    errorDiv.textContent = 'Network error. Please check your connection and try again.';
    errorDiv.style.display = 'block';
    proceedBtn.disabled = false;
    proceedBtn.textContent = 'Proceed';
  }
}

</script>
</body>
</html>